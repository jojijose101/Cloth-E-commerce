{% extends 'base.html' %}
{% load static %}

{% block meta %}
<meta name="description" content="{{ category.desc|truncatewords:155 }}">
{% endblock %}

{% block title %}
{% if category %}{{ category.name }} - Mocajo Online Shop{% else %}Mocajo Online Shop{% endif %}
{% endblock %}
{% block link %}<link rel="stylesheet" href="{% static 'css/home.css' %}">  {% endblock %}
{% block content %}

<!-- HERO / CATEGORY HEADER -->
<section class="hero-wrap mb-4">
  <div class="hero-card">
    {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }} mb-3">{{ message }}</div>
            {% endfor %}
          {% endif %}

          {% if error %}
            <div class="alert alert-danger mb-3">{{ error }}</div>
          {% endif %}
    {% if category %}
      <div class="hero-grid">
        <div class="hero-text">
          <div class="hero-kicker">Category</div>
          <h1 class="hero-title">{{ category.name }}</h1>
          <p class="hero-desc">{{ category.desc }}</p>
        </div>

        <div class="hero-media">
          <img src="{{ category.img.url }}" alt="{{ category.name }}" class="hero-image">
        </div>
      </div>
    {% else %}
      <div id="homeHero" class="carousel slide hero-carousel" data-bs-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active" data-bs-interval="10000">
            <img src="{% static 'img/bn.jpg' %}" class="d-block w-100 hero-carousel-img" alt="Mocajo banner">
            <div class="carousel-caption hero-caption">
              <div class="hero-caption-card">
                <div class="hero-caption-title">Moc<span>ajo</span></div>
                <div class="hero-caption-sub">Discover fresh styles curated for you</div>
              </div>
            </div>
          </div>

          {% for i in links %}
          <div class="carousel-item">
            <img src="{{ i.img.url }}" class="d-block w-100 hero-carousel-img" alt="{{ i.name }}">
            <div class="carousel-caption hero-caption">
              <div class="hero-caption-card">
                <div class="hero-caption-title small">{{ i.name }} <span>collection</span></div>
                <div class="hero-caption-sub">New arrivals • Best picks</div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#homeHero" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#homeHero" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>

      <div class="hero-quote mt-3">
        <p>
          “When a moment appears special—by beauty or experience—I capture it. It’s my hope that
          photography sheds light onto what I see and do daily.”
        </p>
      </div>
    {% endif %}
  </div>
</section>

<!-- SECTION HEADER -->
{% if category is None %}
<div class="section-head">
  <h2 class="section-title">Recommended items</h2>
  <p class="section-sub">Handpicked choices to match your taste</p>
</div>
{% endif %}

<!-- PRODUCTS GRID -->
<section class="mb-4">
  <div class="row g-3 g-lg-4">
    {% for pro in products %}
    <div class="col-6 col-md-4 col-lg-3">
      <div class="product-card">

        <div class="product-media">
          <a href="{{ pro.get_url }}" class="product-link">
            <img src="{{ pro.img.url }}" alt="{{ pro.name }}" class="product-img">
          </a>

          <div class="product-badges">
            <span class="badge-stock">Stock: {{ pro.stock }}</span>
          </div>
        </div>

        <div class="product-body">
          <a href="{{ pro.get_url }}" class="product-name">{{ pro.name }}</a>

          <div class="product-price">
            <span class="price">₹{{ pro.price }}</span>
          </div>

          <a href="{{ pro.get_url }}" class="btn btn-sage w-100 mt-2">View product</a>
        </div>

      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- PAGINATION -->
{% if products.paginator.num_pages > 1 %}
<nav class="site-pagination mt-4" aria-label="Products pagination">
  <div class="pagination-wrap">

    {% for pg in products.paginator.page_range %}
      {% if products.number == pg %}
        <span class="page-pill active">{{ pg }}</span>
      {% else %}
        <a class="page-pill" href="?page={{ pg }}">{{ pg }}</a>
      {% endif %}
    {% endfor %}

  </div>
</nav>
{% endif %}

{% endblock %}