{% extends 'base.html' %}
{% load static %}

{% block meta %}
<meta name="description" content="Order - #{{ order.id }}">
{% endblock %}

{% block title %}
Order #{{ order.id }} - Mocajo Online Shop
{% endblock %}
{% block link %}<link rel="stylesheet" href="{% static 'css/my-order.css' %}">  {% endblock %}
{% block content %}

<div class="section-head mb-3">
  <div>
    <h2 class="section-title mb-1">Order #{{ order.id }}</h2>
    <p class="section-sub mb-0">{{ order.created_at|date:"M d, Y · h:i A" }}</p>
  </div>

  <a class="btn btn-sage-outline" href="{% url 'moc_app:my_orders' %}">
    <i class="fas fa-arrow-left me-2"></i>Back
  </a>
</div>

<!-- Summary cards -->
<div class="row g-3 g-lg-4 mb-4">
  <div class="col-6 col-lg-3">
    <div class="od-card">
      <div class="od-label">Status</div>
      <div class="od-value">
        <span class="status-pill status-{{ order.status|lower }}">{{ order.status }}</span>
      </div>
    </div>
  </div>

  <div class="col-6 col-lg-3">
    <div class="od-card">
      <div class="od-label">Payment</div>
      <div class="od-value">
        {% if order.is_paid %}
          <span class="pay-pill paid">PAID</span>
        {% else %}
          <span class="pay-pill pending">PENDING</span>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-6 col-lg-3">
    <div class="od-card">
      <div class="od-label">Total</div>
      <div class="od-total">₹{{ order.total_amount }}</div>
    </div>
  </div>
<div class="col-6 col-lg-3">
  <div class="od-card">
    <div class="od-label">Payment Method</div>
    <div class="od-value">
      <span class="pm-pill pm-{{ order.payment_method|lower }}">
        {% if order.payment_method == "cod" %}
          COD
        {% else %}
          Online
        {% endif %}
      </span>
    </div>
  </div>
</div>
  {% if order.payment_method == "online" %}
<div class="col-6 col-lg-3">
  <div class="od-card">
    <div class="od-label">Razorpay Order</div>
    <div class="od-rzp">{{ order.razorpay_order_id|default:"—" }}</div>
  </div>
</div>
{% endif %}
</div>

<!-- Items -->
<div class="od-panel">
  <div class="od-panel-head">
    <h5 class="mb-0">Items</h5>
  </div>

  <div class="od-panel-body">
    {% if items %}
      <!-- Desktop table -->
      <div class="table-responsive d-none d-lg-block">
        <table class="table align-middle mb-0 od-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Variant</th>
              <th class="text-end">Qty</th>
              <th class="text-end">Price</th>
            </tr>
          </thead>
          <tbody>
            {% for it in items %}
            <tr>
              <td class="fw-bold">{{ it.product.name }}</td>
              <td class="text-muted">
                {{ it.size|default:"—" }}{% if it.color %} • {{ it.color }}{% endif %}
              </td>
              <td class="text-end fw-bold">{{ it.quantity }}</td>
              <td class="text-end fw-bold">₹{{ it.price }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Mobile cards -->
      <div class="d-lg-none d-grid gap-3">
        {% for it in items %}
          <div class="od-item">
            <div class="fw-bold">{{ it.product.name }}</div>
            <div class="small text-muted mt-1">
              Variant:
              {{ it.size|default:"—" }}{% if it.color %} • {{ it.color }}{% endif %}
            </div>

            <div class="od-item-row mt-3">
              <span class="text-muted">Qty</span>
              <span class="fw-bold">{{ it.quantity }}</span>
            </div>

            <div class="od-item-row mt-2">
              <span class="text-muted">Price</span>
              <span class="fw-bold">₹{{ it.price }}</span>
            </div>
          </div>
        {% endfor %}
      </div>

    {% else %}
      <div class="text-muted">No items found for this order.</div>
    {% endif %}
  </div>
</div>

{% endblock %}